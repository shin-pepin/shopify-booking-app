{% comment %}äºˆç´„ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ App Block{% endcomment %}

{% schema %}
{
  "name": "äºˆç´„ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼",
  "target": "section",
  "javascript": "booking-widget.js",
  "stylesheet": "booking-widget.css",
  "settings": [
    {
      "type": "text",
      "id": "widget_title",
      "label": "ã‚¿ã‚¤ãƒˆãƒ«",
      "default": "äºˆç´„æ—¥æ™‚ã‚’é¸æŠ"
    },
    {
      "type": "select",
      "id": "theme",
      "label": "ãƒ†ãƒ¼ãƒ",
      "options": [
        { "value": "light", "label": "ãƒ©ã‚¤ãƒˆ" },
        { "value": "dark", "label": "ãƒ€ãƒ¼ã‚¯" }
      ],
      "default": "light"
    },
    {
      "type": "range",
      "id": "slot_interval",
      "label": "ã‚¹ãƒ­ãƒƒãƒˆé–“éš”ï¼ˆåˆ†ï¼‰",
      "min": 15,
      "max": 60,
      "step": 15,
      "default": 30
    }
  ]
}
{% endschema %}

<div class="booking-widget" data-proxy-base="/apps/booking" data-theme="{{ block.settings.theme }}" data-slot-interval="{{ block.settings.slot_interval }}">
  <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­ -->
  <div data-loading style="display:flex;flex-direction:column;align-items:center;padding:40px">
    <div class="booking-widget__spinner"></div>
    <p>èª­ã¿è¾¼ã¿ä¸­...</p>
  </div>

  <!-- ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå¿…è¦ãªå ´åˆ -->
  <div data-setup-required style="display:none">
    <div class="booking-widget__setup">
      <div class="booking-widget__setup-icon">ğŸ“…</div>
      <h3 class="booking-widget__setup-title">äºˆç´„ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</h3>
      <p class="booking-widget__setup-text" data-setup-message>
        ç¾åœ¨æº–å‚™ä¸­ã§ã™ã€‚<br>
        ã‚‚ã†ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚
      </p>
    </div>
  </div>

  <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
  <div data-content style="display:none">
    <div class="booking-widget__header">
      <h3 class="booking-widget__title">{{ block.settings.widget_title }}</h3>
    </div>

    <div class="booking-widget__section" data-section="location">
      <label class="booking-widget__label">åº—èˆ—ã‚’é¸æŠ</label>
      <select class="booking-widget__select" data-location-select>
        <option value="">åº—èˆ—ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
      </select>
    </div>

    <div class="booking-widget__section" data-section="resource" style="display:none">
      <label class="booking-widget__label">æ‹…å½“ã‚’é¸æŠ</label>
      <div data-resource-list></div>
    </div>

    <div class="booking-widget__section" data-section="calendar" style="display:none">
      <label class="booking-widget__label">æ—¥ä»˜ã‚’é¸æŠ</label>
      <div class="booking-widget__calendar-nav">
        <button type="button" class="booking-widget__nav-btn" data-prev-month>â—€</button>
        <span class="booking-widget__month-year" data-month-year></span>
        <button type="button" class="booking-widget__nav-btn" data-next-month>â–¶</button>
      </div>
      <div class="booking-widget__calendar">
        <div class="booking-widget__weekdays">
          <span>æ—¥</span><span>æœˆ</span><span>ç«</span><span>æ°´</span><span>æœ¨</span><span>é‡‘</span><span>åœŸ</span>
        </div>
        <div class="booking-widget__days" data-calendar-days></div>
      </div>
    </div>

    <div class="booking-widget__section" data-section="slots" style="display:none">
      <label class="booking-widget__label"><span data-selected-date-display></span>ã®ç©ºãæ™‚é–“</label>
      <div class="booking-widget__slots" data-slot-list></div>
    </div>

    <div class="booking-widget__summary" data-summary style="display:none">
      <h4 class="booking-widget__summary-title">äºˆç´„å†…å®¹</h4>
      <div class="booking-widget__summary-item">
        <span class="booking-widget__summary-label">åº—èˆ—</span>
        <span class="booking-widget__summary-value" data-summary-location>-</span>
      </div>
      <div class="booking-widget__summary-item">
        <span class="booking-widget__summary-label">æ‹…å½“</span>
        <span class="booking-widget__summary-value" data-summary-resource>-</span>
      </div>
      <div class="booking-widget__summary-item">
        <span class="booking-widget__summary-label">æ—¥æ™‚</span>
        <span class="booking-widget__summary-value" data-summary-datetime>-</span>
      </div>
      <button type="button" class="booking-widget__reset-btn" data-reset>é¸æŠã‚’ã‚„ã‚Šç›´ã™</button>
    </div>

    <input type="hidden" name="properties[_BookingStart]" data-booking-start value="">
    <input type="hidden" name="properties[_BookingEnd]" data-booking-end value="">
    <input type="hidden" name="properties[_ResourceId]" data-resource-id value="">
    <input type="hidden" name="properties[_ResourceName]" data-resource-name value="">
    <input type="hidden" name="properties[_LocationId]" data-location-id value="">
    <input type="hidden" name="properties[_LocationName]" data-location-name value="">
    <input type="hidden" name="properties[äºˆç´„æ—¥æ™‚]" data-display-datetime value="">

    <div class="booking-widget__error" data-error style="display:none">
      <p data-error-message></p>
    </div>
  </div>
</div>
